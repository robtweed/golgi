export function apis(t){let e=(t=t||{}).conduit.rest_host||"",a="X-CustomHeader";async function r(e,r,n,i,s){void 0===s&&(s=!0);let o={method:(e=e||"GET").toUpperCase(),headers:{"Content-type":"application/json"}};t.jwt&&s&&(o.headers[a]="Token "+t.jwt),i&&(o.body=JSON.stringify(i));let l=await fetch(r,o),c=await l.json();return!c.error&&n?c[n]:c}return{apis:{getArticlesList:async function(t,a,n){let i=e+"/api/articles?offset="+(t=t||0)+"&limit="+(a=a||10);return n&&(n.author&&(i=i+"&author="+n.author),n.favourited&&(i=i+"&favorited="+n.favourited),n.tag&&(i=i+"&tag="+encodeURIComponent(n.tag))),await r("get",i)},getArticlesFeed:async function(t,a){let n=e+"/api/articles/feed?offset="+(t=t||0)+"&limit="+(a=a||10);return await r("get",n)},getTags:async function(){let t=e+"/api/tags";return await r("get",t,"tags",null,null)},getProfile:async function(a){a=a||t.author;let n=e+"/api/profiles/"+a;return await r("get",n,"profile")},getArticleBySlug:async function(a){a=a||t.slug;let n=e+"/api/articles/"+a;return await r("get",n,"article")},getComments:async function(a){a=a||t.slug;let n=e+"/api/articles/"+a+"/comments";return await r("get",n,"comments")},registerUser:async function(t,a,n){let i;if(a&&""!==a||(i||(i={}),i.email=["can't be empty"]),t&&""!==t||(i||(i={}),i.username=["can't be empty"]),n&&""!==n||(i||(i={}),i.password=["can't be empty"]),i)return{errors:i};let s=e+"/api/users",o={user:{username:t,email:a,password:n}};return await r("post",s,null,o,!1)},authenticateUser:async function(t,a){let n;if(a=a||"",""===(t=t||"")||""===a)return{errors:n={"email or password":["is invalid"]}};let i=e+"/api/users/login",s={user:{email:t,password:a}};return await r("post",i,null,s,!1)},getUser:async function(r){r=r||t.jwt;let n=e+"/api/user",i={method:"GET",headers:{"Content-type":"application/json"}};i.headers[a]="Token "+r;let s=await fetch(n,i);return await s.json()},follow:async function(t){let a=e+"/api/profiles/"+t+"/follow";return await r("post",a)},unfollow:async function(t){let a=e+"/api/profiles/"+t+"/follow";return await r("delete",a)},favourite:async function(t){let a=e+"/api/articles/"+t+"/favorite";return await r("post",a)},unfavourite:async function(t){let a=e+"/api/articles/"+t+"/favorite";return await r("delete",a)},addComment:async function(a,n){let i;if(!n||""===n)return{errors:i={comment:["is empty"]}};if(!t.jwt)return{errors:i={user:["is not authenticated"]}};let s=e+"/api/articles/"+a+"/comments",o={comment:{body:n}};return await r("post",s,null,o)},deleteComment:async function(r,n){let i,s=t.jwt;if(!s)return{errors:i={user:["is not authenticated"]}};let o=e+"/api/articles/"+r+"/comments/"+n,l={method:"DELETE",headers:{"Content-type":"application/json"}};l.headers[a]="Token "+s;let c,u=await fetch(o,l);try{c=await u.json()}catch(t){c={}}return c},createArticle:async function(a,n,i,s){let o;if(a&&""!==a||(o||(o={}),o.title=["can't be empty"]),n&&""!==n||(o||(o={}),o.description=["can't be empty"]),i&&""!==i||(o||(o={}),o.body=["can't be empty"]),t.jwt||(o||(o={}),error.user=["is not authenticated"]),o)return{errors:o};let l=e+"/api/articles",c={article:{title:a,description:n,body:i,tagList:s||[]}};return await r("post",l,null,c)},deleteArticle:async function(r){let n,i=t.jwt;if(!i)return{errors:n={user:["is not authenticated"]}};let s=e+"/api/articles/"+r,o={method:"delete",headers:{"Content-type":"application/json"}};o.headers[a]="Token "+i;let l,c=await fetch(s,o);try{l=await c.json()}catch(t){l={}}return l},updateArticle:async function(a,n,i,s,o){let l;if(n&&""!==n||(l||(l={}),l.title=["can't be empty"]),i&&""!==i||(l||(l={}),l.description=["can't be empty"]),s&&""!==s||(l||(l={}),l.body=["can't be empty"]),t.jwt||(l||(l={}),error.user=["is not authenticated"]),l)return{errors:l};let c=e+"/api/articles/"+a,u={article:{title:n,description:i,body:s,tagList:o||[]}};return await r("put",c,null,u)},updateUser:async function(a){let n,i=a.email,s=a.username;if(i&&""!==i||(n||(n={}),n.email=["can't be empty"]),s&&""!==s||(n||(n={}),n.username=["can't be empty"]),t.jwt||(n||(n={}),error.user=["is not authenticated"]),n)return{errors:n};let o=e+"/api/user",l={user:a};return await r("put",o,null,l)}}}};