function load(){let e="conduit-root",t=-1;customElements.define(e,class extends HTMLElement{constructor(){super(),t++;this.html=`<div class="d-flex flex-column"><nav class="navbar navbar-light"><div class="container"><a class="navbar-brand" href="#" golgi:prop="headerTitle" golgi:on_click="home_page">conduit</a><ul id="header" class="nav navbar-nav pull-xs-right"><li class="nav-item"><!-- Add "active" class when you're on that page" --> <a class="nav-link active" href="#" golgi:prop="homeLink" golgi:on_click="home_page">Home</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="signInLink" golgi:on_click="login">Sign in</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="signUpLink" golgi:on_click="signup">Sign up</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="newPostLink" golgi:on_click="new_article"><i class="ion-compose"></i> New Post</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="settingsLink" golgi:on_click="settings"><i class="ion-gear-a"></i> Settings</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="userLink" golgi:on_click="profile"><img class="user-img" src="golgi:bind=userImage" golgi:prop="userImg" decoding="async"> <span golgi:prop="username">golgi:bind=username</span></a></li></ul></div></nav><div class="container-fluid" golgi:prop="contentTarget"></div><footer><div class="container"><a href="/" class="logo-font" golgi:prop="footerTitle">conduit</a> <span class="attribution" golgi:prop="footerAttribution">An interactive learning project from <a href="https://thinkster.io">Thinkster</a>. Code &amp; design licensed under MIT.</span></div></footer></div>`,this.name=e+"-"+t}onBeforeState(){this.contentPages=new Map,this.pageComponent=new Map,this.pageData=new Map,this.navLinks=new Map,this.defaultImage="https://static.productionready.io/images/smiley-cyrus.jpg",this.context.conduit&&this.context.conduit.defaultImage&&(this.defaultImage=this.context.conduit.defaultImage),this.navLinks.set("homeLink",this.homeLink),this.navLinks.set("signInLink",this.signInLink),this.navLinks.set("signUpLink",this.signUpLink),this.navLinks.set("newPostLink",this.newPostLink),this.navLinks.set("settingsLink",this.settingsLink),this.navLinks.set("userLink",this.userLink),this.showLoggedOutOptions()}settings(){this.switchToPage("settings")}home_page(){this.switchToPage("home_page")}login(){this.switchToPage("login")}signup(){this.switchToPage("signup")}new_article(){this.switchToPage("new_article")}profile(){var e={author:this.user.username};this.switchToPage("profile",e)}setPageActive(e,t){let i;for(i of this.contentPages.values())i.hide();(i=this.contentPages.get(e)).show();let s=this.pageComponent.get(e);s&&s.onSelected&&s.onSelected(t)}async switchToPage(e,t){this.contentPages.has(e)||await this.renderAssembly(e,this.contentTarget,this.context),this.setPageActive(e,t)}setState(e){e.title&&(this.headerTitle.textContent=e.title)}setActiveNavLink(e){let t;for(t of this.navLinks.values())t.classList.remove("active");(t=this.navLinks.get(e)).classList.add("active")}async addArticles(e,t,i){await this.renderComponentMap("conduit-article-preview",t,this.context,e,i)}normaliseArticles(e){let i=[];return e.articles&&e.articles.forEach(e=>{let t=e.author.image;t&&""!==t||(t=this.defaultImage),i.push({slug:e.slug,author:e.author.username,date:this.formatDate(e.createdAt),title:e.title||"",text:e.body,favoritesCount:e.favoritesCount||"",image:t,tags:e.tagList,following:e.author.following,favorited:e.favorited||!1})}),{articlesArr:i,articlesCount:e.articlesCount}}removeArticles(e){this.removeAllByName("conduit-article-preview",e),e.textContent=""}async addPagination(t,i,s,n){if(console.log("addPagination..."),console.log(t),console.log(i),console.log(s),console.log(n),(n=n||10)<t){let e=Math.floor(t/n);0<t%n&&e++,console.log("*** noOfLinks = "+e);for(let t=0;t<e;t++){let e=await this.renderComponent("conduit-pagination-link",i,this.context);e.setState({no:t+1,limit:n,classification:s})}}}removePagination(e){this.removeAllByName("conduit-pagination-link",e)}getContentPage(e){return this.contentPages.get(e)}show(e){e.style="display:"}hide(e){e.style="display: none"}formatDate(e){let t=new Date(e);return["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()}showLoggedOutOptions(){this.show(this.signInLink),this.show(this.signUpLink),this.hide(this.newPostLink),this.hide(this.settingsLink),this.hide(this.userLink)}showLoggedInOptions(){this.hide(this.signInLink),this.hide(this.signUpLink),this.show(this.newPostLink),this.show(this.settingsLink),this.show(this.userLink),this.golgi_state.user={userImage:this.user.image||this.defaultImage,username:this.user.username}}async addErrors(e,t){this.clearErrors(t);let i;for(i in e)for(var s of e[i]){let e=await this.renderComponent("conduit-error",t,this.context);e.setText(i+" "+s)}}clearErrors(e){this.removeAllByName("conduit-error",e)}async loginWithJWT(){let e=localStorage.getItem("conduit-jwt");var t;e&&(1e3*jwt_decode(e).exp<Date.now()?(e=null,localStorage.removeItem("conduit-jwt")):"error"===(t=await this.apis.getUser(e)).status||t.errors||t.error?(log&&(console.log("getUser error:"),console.log(t)),e=null,localStorage.removeItem("conduit-jwt"),delete this.rootComponent.jwt):this.loggedIn(t.user))}loggedIn(e){""===e.image&&(e.image=this.defaultImage||"");var t=e.token;this.jwt=t,this.context.jwt=t,localStorage.setItem("conduit-jwt",t),this.user=e,this.pageComponent.has("home_page")&&this.pageComponent.get("home_page").refresh_home_page()}loggedOut(){delete this.jwt,delete this.context.jwt,delete this.user,localStorage.removeItem("conduit-jwt");["home_page","new_article","article","profile","signup","login","settings"].forEach(e=>{let t=this.getComponentByName("CONDUIT-CONTENT-PAGE",e);t&&(t.remove(),this.contentPages.delete(e),this.pageComponent.delete(e))}),this.switchToPage("home_page")}isLoggedIn(){return!!this.jwt}})}export{load};