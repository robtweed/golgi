let golgi_components = [];
golgi_components.push(function load(){let t="conduit-article-preview",i=-1;customElements.define(t,class extends HTMLElement{constructor(){super(),i++;this.html='<div class="article-preview"><div class="article-meta"><a href="#" golgi:prop="authorImgLink" golgi:on_click="profile"><img src="golgi:bind=image" decoding="async"></a><div class="info"><a href="#" golgi:prop="authorEl" golgi:on_click="profile">golgi:bind=author</a> <span golgi:prop="dateEl">golgi:bind=date</span></div><button class="btn btn-outline-primary btn-sm pull-xs-right" golgi:prop="favoritedBtn" golgi:on_click="favorite_toggle"><i class="ion-heart"></i> <span golgi:prop="favoritesCountEl">golgi:bind=favoritesCount</span></button></div><a href="#" class="preview-link" golgi:prop="articleLink" golgi:on_click="displayArticle"><h1>golgi:bind=title</h1><p>golgi:bind=text</p><span class="preview-readmore">Read more...</span><ul class="tag-list" golgi:prop="tagListEl"></ul></a></div>',this.name=t+"-"+i}setState(t){t.name&&(this.name=t.name)}displayArticle(){this.rootComponent.switchToPage("article",{slug:this.slug})}async favorite_toggle(){var t;this.rootComponent.isLoggedIn()?this.favorited?(t=await this.rootComponent.apis.unfavourite(this.slug)).error||this.toggleFavoritedBtn(t.article.favorited,t.article.favoritesCount):(t=await this.rootComponent.apis.favourite(this.slug)).error||this.toggleFavoritedBtn(t.article.favorited,t.article.favoritesCount):this.rootComponent.switchToPage("login",{returnTo:"home_page"})}profile(){var t;this.author&&(t={author:this.author},this.rootComponent.switchToPage("profile",t))}toggleFavoritedBtn(t,i){this.favorited=t,this.favoritesCountEl.textContent=i,this.setFavoritedBtnStyle()}setFavoritedBtnStyle(){this.favorited?(this.favoritedBtn.classList.add("btn-primary"),this.favoritedBtn.classList.remove("btn-outline-primary")):(this.favoritedBtn.classList.remove("btn-primary"),this.favoritedBtn.classList.add("btn-outline-primary")),this.favoritedBtn.blur()}async onDataUpdated(t){this.favorited=t.favorited,this.setFavoritedBtnStyle(),this.slug=t.slug,this.author=t.author,t.tags&&await this.renderComponentMap("conduit-article-tag",this.tagListEl,this.context,t.tags,"slug_"+t.slug)}})});
golgi_components.push(function load(){let t="conduit-article-tag",e=-1;customElements.define(t,class extends HTMLElement{constructor(){super(),e++;this.html='<li class="tag-default tag-pill tag-outline"><span>golgi:bind</span></li>',this.name=t+"-"+e}setState(t){t.name&&(this.name=t.name)}})});
golgi_components.push(function load(){let t="conduit-article",e=-1;customElements.define(t,class extends HTMLElement{constructor(){super(),e++;this.html='<div class="article-page"><div class="banner"><div class="container"><h1>golgi:bind=title</h1><div class="article-meta"><a golgi:prop="authorImgLink" href="#" golgi:on_click="profile"><img golgi:prop="authorImg" src="golgi:bind=image" decoding="async"></a><div class="info"><a href="#" golgi:prop="authorEl" golgi:on_click="profile">golgi:bind=author</a> <span class="date">golgi:bind=date</span></div><button golgi:prop="followBtn" class="btn btn-sm btn-outline-secondary" golgi:on_click="follow_toggle"><i class="ion-plus-round"></i> &nbsp; <span class="follow-toggle">golgi:bind=following</span> <span class="follow-author">golgi:bind=author</span></button> &nbsp;&nbsp; <button golgi:prop="favouriteBtn" class="btn btn-sm btn-outline-primary" golgi:on_click="favorite_toggle"><i class="ion-heart"></i> &nbsp; <span class="favourite-toggle">golgi:bind=favorited</span> <span class="counter">golgi:bind=favoritesCount</span></button> <span golgi:prop="maintenanceEl" class="article-maintain"><button golgi:prop="editArticleBtn" class="btn btn-sm btn-outline-secondary" golgi:on_click="editArticle"><i class="ion-edit"></i> <span>Edit Article</span></button> <button golgi:prop="deleteArticleBtn" class="btn btn-sm btn-outline-danger" golgi:on_click="deleteArticle"><i class="ion-trash-a"></i> <span>Delete Article</span></button></span></div></div></div><div class="container page"><div class="row article-content"><div class="col-xs-12"><div class="content-body">golgi:bind=body</div><ul golgi:prop="tagListEl" class="tag-list"></ul></div></div><hr><div class="row"><div class="col-xs-12 col-md-8 offset-md-2"><div golgi:prop="loggedOutEl" class="not-logged-in"><p><a golgi:prop="signInEl" class="sign-in" href="#" golgi:on_click="login">Sign in</a> &nbsp;or&nbsp; <a golgi:prop="signUpEl" class="sign-up" href="#" golgi:on_click="signup">sign up</a> to add comments on this article</p></div><div golgi:prop="loggedInEl" class="logged-in"><form class="card comment-form" golgi:on_submit="postComment"><div class="card-block"><textarea golgi:prop="commentFormText" class="form-control" placeholder="Write a comment..." rows="3"></textarea></div><div class="card-footer"><img src="golgi:bind=image" class="comment-author-img" decoding="async"> <button class="btn btn-sm btn-primary">Post Comment</button></div></form></div><div golgi:prop="commentsEl" class="article-comments"></div></div></div></div></div>',this.name=t+"-"+e}async follow_toggle(){if(this.rootComponent.isLoggedIn()){let t;"Follow"===this.article.following?(t=await this.rootComponent.apis.follow(this.article.author),console.log("follow results: "+JSON.stringify(t,null,2)),t.error||(this.article.following="Unfollow",this.golgi_state.article=this.article,this.rootComponent.pageComponent.get("home_page").refresh_home_page())):(t=await this.rootComponent.apis.unfollow(this.article.author),console.log("unfollow results: "+JSON.stringify(t,null,2)),t.error||(this.article.following="Follow",this.golgi_state.article=this.article,this.rootComponent.pageComponent.get("home_page").refresh_home_page())),this.followBtn.blur()}else this.rootComponent.switchToPage("login",{returnTo:"article"})}async favorite_toggle(){var t;this.rootComponent.isLoggedIn()?("Favorite Article"===this.article.favorited?(t=await this.rootComponent.apis.favourite(this.article.slug)).error||(this.article.favoritesCount=t.article.favoritesCount,this.article.favorited="Unfavorite Article",this.golgi_state.article=this.article,this.rootComponent.pageComponent.get("home_page").refresh_home_page()):(t=await this.rootComponent.apis.unfavourite(this.article.slug)).error||(this.article.favorited="Favorite Article",this.article.favoritesCount=t.article.favoritesCount,this.golgi_state.article=this.article,this.rootComponent.pageComponent.get("home_page").refresh_home_page()),this.favoriteBtn.blur()):this.rootComponent.switchToPage("login",{returnTo:"article"})}profile(){this.context.author=this.article.author;var t={author:this.author};this.rootComponent.switchToPage("profile",t)}async postComment(o){o.preventDefault();o=await this.rootComponent.apis.addComment(this.slug,this.commentFormText.value);if(!o.error){o=this.normaliseComment(o.comment);this.commentFormText.value="";let t=await this.renderComponent("conduit-comment",this.commentsEl,this.context);var i="newComment"+ ++e;t.addStateMap(i),this.golgi_state[i]=o}}login(){this.rootComponent.switchToPage("login",{returnTo:"article"})}signup(){this.rootComponent.switchToPage("signup",{returnTo:"article"})}editArticle(){var t={editing_article:this.article};this.rootComponent.switchToPage("new_article",t)}async deleteArticle(){(await this.rootComponent.apis.deleteArticle(this.slug)).errors||this.rootComponent.switchToPage("home_page",{refresh_home_page:!0})}onDataUpdated(t){this.rootComponent.isLoggedIn()&&this.rootComponent.user.username===t.author?(this.hide(this.followBtn),this.hide(this.favouriteBtn),this.show(this.maintenanceEl)):(this.show(this.followBtn),this.show(this.favouriteBtn),this.hide(this.maintenanceEl)),t.tags&&(this.removeTags(),this.addTags(t.tags))}async addTags(t){await this.renderComponentMap("conduit-article-tag",this.tagListEl,this.context,t,"article_tags")}removeTags(){this.removeAllByName("conduit-article-tag",this.tagListEl)}async fetchArticle(t){t=await this.rootComponent.apis.getArticleBySlug(t);this.normaliseArticle(t)}normaliseArticle(t){console.log("**** normalising article *&*****"),console.log(t),t.image=t.author.image,t.tags=t.tagList,this.rootComponent.isLoggedIn()&&(t.userImage=this.rootComponent.user.image),t.date=this.rootComponent.formatDate(t.updatedAt),t.favoritesCount="("+t.favoritesCount+")",t.rawBody=t.body,t.body=this.markdownConverter.makeHtml(t.body),!1===t.author.following?t.following="Follow":t.following="Unfollow",!1===t.favorited?t.favorited="Favorite Article":t.favorited="Unfavorite Article",t.author=t.author.username,void 0!==t.image&&""!==t.image||(t.image=this.rootComponent.defaultImage),this.article=t}async getAndDisplayArticle(t){await this.fetchArticle(t);this.golgi_state.article=this.article}async getAndDisplayComments(t){this.removeComments();let i=await this.rootComponent.apis.getComments(t),e=(console.log("slug = "+t),console.log("**** comments: "+JSON.stringify(i,null,2)),this);i.forEach(function(t,o){i[o]=e.normaliseComment(t)}),await this.renderComponentMap("conduit-comment",this.commentsEl,this.context,i,"comments")}removeComments(){this.removeAllByName("conduit-comment",this.commentsEl)}async addComment(t){console.log("adding comment using:"),console.log(t);let o=await this.renderComponent("conduit-comment",this.commentsEl,this.context);o.addStateMap(o.name),this.golgi_state[o.name]=t}normaliseComment(t){return t.date=this.rootComponent.formatDate(t.updatedAt),t.image=t.author.image,void 0!==t.image&&""!==t.image||(t.image=this.rootComponent.defaultImage),t.author=t.author.username,t.slug=this.slug,t}show(t){t.style="display:"}hide(t){t.style="display: none"}onSelected(t){this.slug=t.slug,this.rootComponent.isLoggedIn()?(this.show(this.loggedInEl),this.hide(this.loggedOutEl)):(this.hide(this.loggedInEl),this.show(this.loggedOutEl)),"article"!==this.context.return_to&&(this.getAndDisplayArticle(this.slug),this.getAndDisplayComments(this.slug),this.rootComponent.homeLink.classList.contains("active")&&this.rootComponent.homeLink.classList.remove("active"))}onBeforeState(){this.markdownConverter=new showdown.Converter}})});
golgi_components.push(function load(){let o="conduit-comment",t=-1;customElements.define(o,class extends HTMLElement{constructor(){super(),t++;this.html='<div class="card"><div class="card-block"><p class="card-text">golgi:bind=body</p></div><div class="card-footer"><a href="#" class="comment-author" golgi:on_click="profile"><img src="golgi:bind=image" class="comment-author-img" alt="golgi:bind=author" decoding="async"> </a>&nbsp; <a href="#" class="comment-author" golgi:on_click="profile">golgi:bind=author</a> <span class="date-posted">golgi:bind=date</span> <span class="mod-options" golgi:prop="deleteIcon" golgi:on_click="deleteComment"><i class="ion-trash-a"></i></span></div></div>',this.name=o+"-"+t}profile(){var o;this.comment&&this.comment.author&&(o={author:this.comment.author},this.rootComponent.switchToPage("profile",o))}async deleteComment(){console.log("deleting "+JSON.stringify(this.comment,null,2)),(await this.rootComponent.apis.deleteComment(this.comment.slug,this.comment.id)).error||this.remove()}onDataUpdated(o){this.comment=o,this.rootComponent.isLoggedIn()&&this.rootComponent.user.username===o.author?this.show(this.deleteIcon):this.hide(this.deleteIcon)}show(o){o.style="display:"}hide(o){o.style="display: none"}})});
golgi_components.push(function load(){let t="conduit-content-page",e=-1;customElements.define(t,class extends HTMLElement{constructor(){super(),e++;this.html='<div class="collapse"></div>',this.name=t+"-"+e}setState(t){t.name&&(this.name=t.name)}show(){this.rootElement.classList.add("show")}hide(){this.rootElement.classList.remove("show")}onBeforeHooks(){this.rootComponent.contentPages.set(this.name,this)}onChildComponentReady(t){this.rootComponent.pageComponent.set(this.name,t),t.name=this.name,t.addStateMap(this.name)}})});
golgi_components.push(function load(){let t="conduit-error",e=-1;customElements.define(t,class extends HTMLElement{constructor(){super(),e++;this.html='<li><span golgi:prop="text"></span></li>',this.name=t+"-"+e}setState(t){t.name&&(this.name=t.name)}setText(t){this.text.textContent=t}})});
golgi_components.push(function load(){let i="conduit-home-page",t=-1;customElements.define(i,class extends HTMLElement{constructor(){super(),t++;this.html='<div class="home-page"><div class="banner" golgi:prop="bannerDiv"><div class="container"><h1 class="logo-font" golgi:prop="bannerLogoDiv">conduit</h1><p golgi:prop="bannerTextDiv">A place to share your knowledge.</p></div></div><div class="container page"><div class="row"><div class="col-md-9"><div class="feed-toggle"><ul class="nav nav-pills outline-active"><li class="nav-item"><a class="nav-link" href="#" golgi:prop="yourFeedLink" golgi:on_click="showYourFeed">Your Feed</a></li><li class="nav-item"><a class="nav-link active" href="#" golgi:prop="globalFeedLink" golgi:on_click="showGlobalFeed">Global Feed</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="byTagFeedLink" golgi:on_click="showByTag">golgi:bind=tag</a></li></ul></div><div class="articles-content"><div golgi:prop="yourArticles"><div golgi:prop="yourArticlesPreview"></div><nav><ul golgi:prop="yourArticlesPagination"></ul></nav></div><div golgi:prop="globalArticles"><div golgi:prop="globalArticlesPreview"></div><nav><ul golgi:prop="globalArticlesPagination"></ul></nav></div><div golgi:prop="byTagArticles"><div golgi:prop="byTagArticlesPreview"></div><nav><ul golgi:prop="byTagArticlesPagination"></ul></nav></div></div></div><div class="col-md-3"><div class="sidebar"><p golgi:prop="sidebarTitleEl">Popular Tags</p><div golgi:prop="tagListDiv"></div></div></div></div></div></div>',this.name=i+"-"+t}setState(i){i.banner&&(i.banner.logo&&(this.bannerLogoDiv.textContent=i.banner.logo),i.banner.text&&(this.bannerTextDiv.textContent=i.banner.text)),i.name&&(this.name=i.name)}showGlobalFeed(){"global"!==this.activeFeed&&this.showGlobalArticles()}showByTag(){"byTag"!==this.activeFeed&&this.showByTagArticles(this.feedTag)}showYourFeed(){"your"!==this.activeFeed&&this.showYourArticles()}sidebarOff(){this.sidebarTitleEl.textContent="",this.tagListDiv.innerHTML=""}async fetchArticles(i,t,e){i=await this.rootComponent.apis.getArticlesList(i,t,e);return this.rootComponent.normaliseArticles(i)}async fetchFeed(i,t){i=await this.rootComponent.apis.getArticlesFeed(i,t);return this.rootComponent.normaliseArticles(i)}async fetchGlobalArticles(i){i=await this.fetchArticles(i=i||0);this.rootComponent.addArticles(i.articlesArr,this.globalArticlesPreview,"global_feed"),this.globalPaginationDisplayed||(await this.rootComponent.addPagination(i.articlesCount,this.globalArticlesPagination,"global",10),this.globalPaginationDisplayed=!0)}async fetchYourArticles(i){i=await this.fetchFeed(i=i||0,10);0===i.articlesCount?this.yourArticlesPreview.innerHTML='<div class="article-preview">No articles are here...yet</div>':(this.rootComponent.addArticles(i.articlesArr,this.yourArticlesPreview,"your_articles"),this.yourPaginationDisplayed||(await this.rootComponent.addPagination.call(this,i.articlesCount,this.yourArticlesPagination,"your",10),this.yourPaginationDisplayed=!0))}async fetchByTagArticles(i,t){t=await this.fetchArticles(t=t||0,10,{tag:i});0===t.articlesCount?this.byTagArticlesPreview.innerHTML='<div class="article-preview">No articles are here...yet</div>':(this.rootComponent.addArticles(t.articlesArr,this.byTagArticlesPreview,"byTag_"+i),this.byTagPaginationDisplayed||(await this.rootComponent.addPagination.call(this,t.articlesCount,this.byTagArticlesPagination,"byTag",10),this.byTagPaginationDisplayed=!0))}getAndDisplayArticles(i,t){this.setFeedLinkActive(t),"global"===t&&(this.rootComponent.removeArticles(this.globalArticlesPreview),this.fetchGlobalArticles(i)),"your"===t&&(this.rootComponent.removeArticles(this.yourArticlesPreview),this.fetchYourArticles(i)),"byTag"===t&&(this.rootComponent.removeArticles(this.byTagArticlesPreview),this.fetchByTagArticles(this.feedTag,i))}show(i){i.style="display:"}hide(i){i.style="display: none"}setFeedLinkActive(i){return"global"===i?(this.globalFeedLink.classList.add("active"),this.yourFeedLink.classList.remove("active"),this.byTagFeedLink.classList.remove("active"),void(this.activeFeed="global")):"your"===i?(this.globalFeedLink.classList.remove("active"),this.yourFeedLink.classList.add("active"),this.byTagFeedLink.classList.remove("active"),this.show(this.yourFeedLink),void(this.activeFeed="your")):void("byTag"===i&&(this.globalFeedLink.classList.remove("active"),this.yourFeedLink.classList.remove("active"),this.byTagFeedLink.classList.add("active"),this.show(this.byTagFeedLink),this.activeFeed="byTag"))}showGlobalArticles(){this.show(this.globalArticles),this.hide(this.yourArticles),this.hide(this.byTagArticles),this.setFeedLinkActive("global"),this.globalArticlesPreview.hasChildNodes()||this.fetchGlobalArticles()}showYourArticles(){this.hide(this.globalArticles),this.show(this.yourArticles),this.hide(this.byTagArticles),this.setFeedLinkActive("your"),this.yourArticlesPreview.hasChildNodes()||this.fetchYourArticles()}showByTagArticles(i,t,e){e&&(this.rootComponent.removeArticles(this.byTagArticlesPreview),this.rootComponent.removePagination(this.byTagArticlesPagination),this.byTagPaginationDisplayed=!1),t=t||0,this.hide(this.globalArticles),this.hide(this.yourArticles),this.show(this.byTagArticles),this.golgi_state.tag="#"+i,this.feedTag=i,this.setFeedLinkActive("byTag"),this.byTagArticlesPreview.hasChildNodes()||this.fetchByTagArticles(i,t)}async getAndDisplayTags(){var i;this.tagsDisplayed||(i=await this.rootComponent.apis.getTags(),Array.isArray(i)&&(this.addTags(i),this.tagsDisplayed=!0))}async addTags(i){let e=this;this.renderComponentMap("conduit-tag",this.tagListDiv,this.context,i,"tags",function(i,t){this.addHandler(()=>{e.showByTagArticles(t,0,!0)})})}removeTags(){this.removeAllByName("conduit-tag",this.tagListDiv),this.tagsDisplayed=!1}refresh_home_page(){this.rootComponent.removeArticles(this.globalArticlesPreview),this.rootComponent.removePagination(this.globalArticlesPagination),this.globalPaginationDisplayed=!1,this.rootComponent.removeArticles(this.yourArticlesPreview),this.rootComponent.removePagination(this.yourArticlesPagination),this.yourPaginationDisplayed=!1,this.rootComponent.removeArticles(this.byTagArticlesPreview),this.rootComponent.removePagination(this.byTagArticlesPagination),this.byTagPaginationDisplayed=!1,this.removeTags(),this.context.refresh_home_page=!1}onSelected(i){if(this.rootComponent.setActiveNavLink("homeLink"),this.rootComponent.isLoggedIn())return i&&i.refresh_home_page&&this.refresh_home_page(),this.show(this.yourFeedLink),this.rootComponent.showLoggedInOptions(),"global"===this.activeFeed?(this.initialView?this.showYourArticles():this.showGlobalArticles(),this.getAndDisplayTags(),void(this.initialView=!1)):"your"===this.activeFeed?(this.showYourArticles(),this.getAndDisplayTags(),void(this.initialView=!1)):void("byTag"===this.activeFeed&&(this.showByTagArticles(this.feedTag),this.getAndDisplayTags(),this.initialView=!1));this.hide(this.yourFeedLink),this.rootComponent.showLoggedOutOptions(),this.showGlobalArticles(),this.getAndDisplayTags()}onBeforeState(){this.initialView=!0,this.activeFeed="global",this.show(this.globalFeedLink),this.hide(this.byTagFeedLink),this.addStateMap("tag")}})});
golgi_components.push(function load(){let o="conduit-login",t=-1;customElements.define(o,class extends HTMLElement{constructor(){super(),t++;this.html='<div class="auth-page"><div class="container page"><div class="row"><div class="col-md-6 offset-md-3 col-xs-12"><h1 class="text-xs-center">Sign In</h1><p class="text-xs-center"><a href="#" golgi:on_click="signup">Need an account?</a></p><ul class="error-messages" golgi:prop="errorsEl"></ul><form golgi:on_submit="login"><fieldset><fieldset class="form-group"><input class="form-control form-control-lg" type="email" placeholder="Email" golgi:prop="email"></fieldset><fieldset class="form-group"><input class="form-control form-control-lg" type="password" placeholder="Password" golgi:prop="password"></fieldset><button class="btn btn-lg btn-primary pull-xs-right">Sign In</button></fieldset></form></div></div></div></div>',this.name=o+"-"+t}setState(o){o.name&&(this.name=o.name)}async login(o){o.preventDefault(),this.errorsEl.textContent="";var o=await this.rootComponent.apis.authenticateUser(this.email.value,this.password.value);o.errors?this.rootComponent.addErrors(o.errors,this.errorsEl):(this.rootComponent.loggedIn(o.user),this.returnTo?(this.rootComponent.showLoggedInOptions(),o={returnTo:this.returnTo},this.rootComponent.switchToPage(this.returnTo,o)):this.rootComponent.switchToPage("home_page"))}signup(){var o={returnTo:this.returnTo};this.rootComponent.switchToPage("signup",o)}onSelected(o){this.rootComponent.clearErrors(this.errorsEl),this.email.value="",this.password.value="",o&&(this.returnTo=o.returnTo)}})});
golgi_components.push(function load(){let t="conduit-new-article-tag",e=-1;customElements.define(t,class extends HTMLElement{constructor(){super(),e++;this.html='<span class="tag-default tag-pill"><i class="ion-close-round" golgi:on_click="removeTag"></i> <span>golgi:bind</span></span>',this.name=t+"-"+e}setState(t){t.name&&(this.name=t.name)}removeTag(){var t=this.parentComponent.tagList.indexOf(this.text);-1<t&&this.parentComponent.tagList.splice(t,1),this.remove()}onDataUpdated(t){this.text=t}})});
golgi_components.push(function load(){let t="conduit-new-article",i=-1;customElements.define(t,class extends HTMLElement{constructor(){super(),i++;this.html=`<div class="editor-page"><div class="container page"><div class="row"><div class="col-md-10 offset-md-1 col-xs-12"><ul class="error-messages" golgi:prop="errorsEl"></ul><form><fieldset><fieldset class="form-group"><input golgi:prop="article_title" type="text" value="golgi:bind=title" class="form-control form-control-lg" placeholder="Article Title"></fieldset><fieldset class="form-group"><input golgi:prop="description" type="text" value="golgi:bind=description" class="form-control" placeholder="What's this article about?"></fieldset><fieldset class="form-group"><textarea golgi:prop="body" class="form-control" rows="8" value="golgi:bind=body" placeholder="Write your article (in markdown)"></textarea></fieldset><fieldset class="form-group"><input golgi:prop="tagListField" type="text" value="golgi:bind=tagListField" class="form-control" placeholder="Enter tags" golgi:on_change="displayTagIcon"><div class="tag-list" golgi:prop="tagListEl"></div></fieldset><button class="btn btn-lg pull-xs-right btn-primary" type="button" golgi:on_click="submitArticle">Publish Article</button></fieldset></form></div></div></div></div>`,this.name=t+"-"+i}setState(t){t.name&&(this.name=t.name)}async displayTagIcon(){console.log("changed!");var t=this.tagListField.value;-1!==this.tagList.indexOf(t)?this.tagListField.value="":(this.tagList.push(t),this.tagListField.value="",await this.addTag(t))}async submitArticle(t){console.log("submit button!");let i;if((i="editing"===this.mode?await this.rootComponent.apis.updateArticle(this.article.slug,this.article_title.value,this.description.value,this.body.value,this.tagList):await this.rootComponent.apis.createArticle(this.article_title.value,this.description.value,this.body.value,this.tagList)).errors)this.rootComponent.addErrors(i.errors,this.errorsEl);else{let t=this.rootComponent.pageComponent.get("home_page");t.refresh_home_page();var e={slug:i.article.slug};this.rootComponent.switchToPage("article",e)}}async addTags(t){this.renderComponentMap("conduit-new-article-tag",this.tagListEl,this.context,t,"new_article_tags")}async addTag(t){let i=await this.renderComponent("conduit-new-article-tag",this.tagListEl,this.context);var e="new_article_tag_"+t;i.addStateMap(e),this.golgi_state[e]=t}onSelected(t){this.rootComponent.clearErrors(this.errorsEl),this.removeAllByName("conduit-new-article-tag",this.tagListEl),t&&t.editing_article?(this.article=t.editing_article,this.mode="editing",this.golgi_state.article_form={title:this.article.title,description:this.article.description,body:this.article.rawBody,tagListField:""},this.addTags(this.article.tagList),this.tagList=this.article.tagList):(this.golgi_state.article_form={title:"",description:"",body:"",tagListField:""},this.tagList=[],this.mode="new")}onBeforeState(){this.addStateMap("article_form")}})});
golgi_components.push(function load(){let t="conduit-pagination-link",i=-1;customElements.define(t,class extends HTMLElement{constructor(){super(),i++;this.html='<li class="page-item"><a class="page-link" href="#" golgi:prop="link" golgi:on_click="displayBatch"></a></li>',this.name=t+"-"+i}setState(t){t.name&&(this.name=t.name),t.ownerPage&&(this.ownerPage=t.ownerPage),t.classification&&(this.classification=t.classification),t.limit&&(this.limit=t.limit),t.no&&(this.no=t.no,this.link.textContent=t.no,1===this.no&&this.active())}displayBatch(){this.active();var t=(this.no-1)*this.limit;this.parentComponent.getAndDisplayArticles(t,this.classification)}active(){this.rootElement.classList.contains("active")||this.rootElement.classList.add("active");let t=this.parentComponent.activeLink;t&&t.rootElement.classList.remove("active"),this.parentComponent.activeLink=this}})});
golgi_components.push(function load(){let i="conduit-profile",t=-1;customElements.define(i,class extends HTMLElement{constructor(){super(),t++;this.html='<div class="profile-page"><div class="user-info"><div class="container"><div class="row"><div class="col-xs-12 col-md-10 offset-md-1"><img src="golgi:bind=image" class="user-img" decoding="async"><h4>golgi:bind=username</h4><p>golgi:bind=bio</p><button class="btn btn-sm btn-outline-secondary action-btn" golgi:prop="followBtn" golgi:on_click="followToggle"><i class="ion-plus-round"></i> &nbsp; <span>golgi:bind=followToggle</span> &nbsp; <span>golgi:bind=username</span></button> <button class="btn btn-sm btn-outline-secondary action-btn" golgi:prop="editProfileBtn" golgi:on_click="editSettings"><i class="ion-gear-a"></i> &nbsp; Edit Profile Settings</button></div></div></div></div><div class="container"><div class="row"><div class="col-xs-12 col-md-10 offset-md-1"><div class="articles-toggle"><ul class="nav nav-pills outline-active"><li class="nav-item"><a class="nav-link active" href="#" golgi:prop="myArticlesLink" golgi:on_click="showMyArticles">My Articles</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="favouritedArticlesLink" golgi:on_click="showFavoritedArticles">Favorited Articles</a></li></ul></div><div><div golgi:prop="myArticles"><div golgi:prop="myArticlesPreview"></div><nav><ul golgi:prop="myArticlesPagination"></ul></nav></div><div golgi:prop="favouritedArticles"><div golgi:prop="favouritedArticlesPreview"></div><nav><ul golgi:prop="favouritedArticlesPagination"></ul></nav></div></div></div></div></div></div>',this.name=i+"-"+t}setState(i){i.name&&(this.name=i.name)}async followToggle(){var i;this.rootComponent.isLoggedIn()?this.profile&&!1===this.profile.following?(i=await this.rootComponent.apis.follow(this.profile.username)).error||(this.profile=this.normaliseProfile(i.profile),this.golgi_state.profile=this.profile,this.rootComponent.pageComponent.get("home_page").refresh_home_page()):(i=await this.rootComponent.apis.unfollow(this.profile.username)).error||(this.profile=this.normaliseProfile(i.profile),this.golgi_state.profile=this.profile,this.rootComponent.pageComponent.get("home_page").refresh_home_page()):this.rootComponent.switchToPage("login",{returnTo:"profile"})}showMyArticles(){this.show(this.myArticles),this.hide(this.favouritedArticles),this.myArticlesLink.classList.contains("active")||this.myArticlesLink.classList.add("active"),this.favouritedArticlesLink.classList.contains("active")&&this.favouritedArticlesLink.classList.remove("active"),this.myArticlesPreview.hasChildNodes()||this.fetchMyArticles()}showFavoritedArticles(){this.show(this.favouritedArticles),this.hide(this.myArticles),this.favouritedArticlesLink.classList.contains("active")||this.favouritedArticlesLink.classList.add("active"),this.myArticlesLink.classList.contains("active")&&this.myArticlesLink.classList.remove("active"),this.favouritedArticlesPreview.hasChildNodes()||this.fetchFavouritedArticles()}editSettings(){this.rootComponent.switchToPage("settings",{returnTo:"profile"})}async fetchArticles(i,t,e){i=await this.rootComponent.apis.getArticlesList(i,t,e);return this.rootComponent.normaliseArticles(i)}async fetchMyArticles(i){var t={author:this.profile.username},i=await this.fetchArticles(i=i||0,5,t);0===i.articlesCount?this.myArticlesPreview.innerHTML='<div class="article-preview">No articles are here...yet</div>':(this.rootComponent.addArticles(i.articlesArr,this.myArticlesPreview,"my_articles"),this.myPaginationDisplayed||(await this.rootComponent.addPagination.call(this,i.articlesCount,this.myArticlesPagination,"my-articles",5),this.myPaginationDisplayed=!0))}async fetchFavouritedArticles(i){var t={favourited:this.profile.username},i=await this.fetchArticles(i=i||0,5,t);0===i.articlesCount?this.favouritedArticlesPreview.innerHTML='<div class="article-preview">No articles are here...yet</div>':(this.rootComponent.addArticles(i.articlesArr,this.favouritedArticlesPreview,"fav_articles"),this.favouritedPaginationDisplayed||(await this.rootComponent.addPagination.call(this,i.articlesCount,this.favouritedArticlesPagination,"favourited-articles",5),this.favouritedPaginationDisplayed=!0))}async getAndDisplayProfile(i){i=await this.rootComponent.apis.getProfile(i);this.profile=this.normaliseProfile(i),this.golgi_state.profile=this.profile,this.removeMyArticles(),this.removeFavouritedArticles(),this.showMyArticles(),this.rootComponent.isLoggedIn()&&this.rootComponent.user.username===this.profile.username?(this.hide(this.followBtn),this.show(this.editProfileBtn)):(this.show(this.followBtn),this.hide(this.editProfileBtn))}normaliseProfile(i){return!1===i.following?i.followToggle="Follow":i.followToggle="Unfollow",i.bio||(i.bio=""),i.image||(i.image=this.rootComponent.defaultImage),i}getAndDisplayArticles(i,t){"my-articles"===t?(this.rootComponent.removeArticles(this.myArticlesPreview),this.fetchMyArticles(i)):"favourited-articles"===t&&(this.rootComponent.removeArticles(this.favouritedArticlesPreview),this.fetchFavouritedArticles(i))}removeMyArticles(){this.rootComponent.removeArticles(this.myArticlesPreview),this.rootComponent.removePagination.call(this,this.myArticlesPagination),this.myPaginationDisplayed=!1,this.myArticlesPreview.textContent=""}removeFavouritedArticles(){this.rootComponent.removeArticles(this.favouritedArticlesPreview),this.rootComponent.removePagination.call(this,this.favouritedArticlesPagination),this.favouritedPaginationDisplayed=!1,this.favouritedArticlesPreview.textContent=""}show(i){i.style="display:"}hide(i){i.style="display: none"}onSelected(i){this.getAndDisplayProfile(i.author)}})});
golgi_components.push(function load(){let t="conduit-root",e=-1;customElements.define(t,class extends HTMLElement{constructor(){super(),e++;this.html=`<div class="d-flex flex-column"><nav class="navbar navbar-light"><div class="container"><a class="navbar-brand" href="#" golgi:prop="headerTitle" golgi:on_click="home_page">conduit</a><ul id="header" class="nav navbar-nav pull-xs-right"><li class="nav-item"><!-- Add "active" class when you're on that page" --> <a class="nav-link active" href="#" golgi:prop="homeLink" golgi:on_click="home_page">Home</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="signInLink" golgi:on_click="login">Sign in</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="signUpLink" golgi:on_click="signup">Sign up</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="newPostLink" golgi:on_click="new_article"><i class="ion-compose"></i> New Post</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="settingsLink" golgi:on_click="settings"><i class="ion-gear-a"></i> Settings</a></li><li class="nav-item"><a class="nav-link" href="#" golgi:prop="userLink" golgi:on_click="profile"><img class="user-img" src="golgi:bind=userImage" golgi:prop="userImg" decoding="async"> <span golgi:prop="username">golgi:bind=username</span></a></li></ul></div></nav><div class="container-fluid" golgi:prop="contentTarget"></div><footer><div class="container"><a href="/" class="logo-font" golgi:prop="footerTitle">conduit</a> <span class="attribution" golgi:prop="footerAttribution">An interactive learning project from <a href="https://thinkster.io">Thinkster</a>. Code &amp; design licensed under MIT.</span></div></footer></div>`,this.name=t+"-"+e}onBeforeState(){this.contentPages=new Map,this.pageComponent=new Map,this.pageData=new Map,this.navLinks=new Map,this.defaultImage="https://static.productionready.io/images/smiley-cyrus.jpg",this.context.conduit&&this.context.conduit.defaultImage&&(this.defaultImage=this.context.conduit.defaultImage),this.addEventListener("apisReady",async()=>{this.context.apis&&this.context.jwt_decode&&(console.log("apisReady event triggered in root assembly"),this.apis=this.context.apis(this.context).apis,await this.loginWithJWT(),this.switchToPage("home_page"))}),this.navLinks.set("homeLink",this.homeLink),this.navLinks.set("signInLink",this.signInLink),this.navLinks.set("signUpLink",this.signUpLink),this.navLinks.set("newPostLink",this.newPostLink),this.navLinks.set("settingsLink",this.settingsLink),this.navLinks.set("userLink",this.userLink),this.showLoggedOutOptions()}settings(){this.switchToPage("settings")}home_page(){this.switchToPage("home_page")}login(){this.switchToPage("login")}signup(){this.switchToPage("signup")}new_article(){this.switchToPage("new_article")}profile(){var t={author:this.user.username};this.switchToPage("profile",t)}setPageActive(t,e){let i;for(i of this.contentPages.values())i.hide();(i=this.contentPages.get(t)).show();let s=this.pageComponent.get(t);s&&s.onSelected&&s.onSelected(e)}async switchToPage(t,e){this.contentPages.has(t)||await this.renderAssembly(t,this.contentTarget,this.context),this.setPageActive(t,e)}setState(t){t.title&&(this.headerTitle.textContent=t.title)}setActiveNavLink(t){let e;for(e of this.navLinks.values())e.classList.remove("active");(e=this.navLinks.get(t)).classList.add("active")}async addArticles(t,e,i){await this.renderComponentMap("conduit-article-preview",e,this.context,t,i)}normaliseArticles(t){let i=[];return t.articles&&t.articles.forEach(t=>{let e=t.author.image;e&&""!==e||(e=this.defaultImage),i.push({slug:t.slug,author:t.author.username,date:this.formatDate(t.createdAt),title:t.title||"",text:t.body,favoritesCount:t.favoritesCount||"",image:e,tags:t.tagList,following:t.author.following,favorited:t.favorited||!1})}),{articlesArr:i,articlesCount:t.articlesCount}}removeArticles(t){this.removeAllByName("conduit-article-preview",t),t.textContent=""}async addPagination(e,i,s,n){if(console.log("addPagination..."),console.log(e),console.log(i),console.log(s),console.log(n),(n=n||10)<e){let t=Math.floor(e/n);0<e%n&&t++,console.log("*** noOfLinks = "+t);for(let e=0;e<t;e++){let t=await this.renderComponent("conduit-pagination-link",i,this.context);t.setState({no:e+1,limit:n,classification:s})}}}removePagination(t){this.removeAllByName("conduit-pagination-link",t)}getContentPage(t){return this.contentPages.get(t)}show(t){t.style="display:"}hide(t){t.style="display: none"}formatDate(t){let e=new Date(t);return["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()}showLoggedOutOptions(){this.show(this.signInLink),this.show(this.signUpLink),this.hide(this.newPostLink),this.hide(this.settingsLink),this.hide(this.userLink)}showLoggedInOptions(){this.hide(this.signInLink),this.hide(this.signUpLink),this.show(this.newPostLink),this.show(this.settingsLink),this.show(this.userLink),this.golgi_state.user={userImage:this.user.image||this.defaultImage,username:this.user.username}}async addErrors(t,e){this.clearErrors(e);let i;for(i in t)for(var s of t[i]){let t=await this.renderComponent("conduit-error",e,this.context);t.setText(i+" "+s)}}clearErrors(t){this.removeAllByName("conduit-error",t)}async loginWithJWT(){let t=localStorage.getItem("conduit-jwt");var e;t&&(1e3*this.context.jwt_decode(t).exp<Date.now()?(t=null,localStorage.removeItem("conduit-jwt")):"error"===(e=await this.apis.getUser(t)).status||e.errors||e.error?(log&&(console.log("getUser error:"),console.log(e)),t=null,localStorage.removeItem("conduit-jwt"),delete this.rootComponent.jwt):this.loggedIn(e.user))}loggedIn(t){""===t.image&&(t.image=this.defaultImage||"");var e=t.token;this.jwt=e,this.context.jwt=e,localStorage.setItem("conduit-jwt",e),this.user=t,this.pageComponent.has("home_page")&&this.pageComponent.get("home_page").refresh_home_page()}loggedOut(){delete this.jwt,delete this.context.jwt,delete this.user,localStorage.removeItem("conduit-jwt");["home_page","new_article","article","profile","signup","login","settings"].forEach(t=>{let e=this.getComponentByName("CONDUIT-CONTENT-PAGE",t);e&&(e.remove(),this.contentPages.delete(t),this.pageComponent.delete(t))}),this.switchToPage("home_page")}isLoggedIn(){return!!this.jwt}})});
golgi_components.push(function load(){let e="conduit-settings",o=-1;customElements.define(e,class extends HTMLElement{constructor(){super(),o++;this.html='<div class="settings-page"><div class="container page"><div class="row"><div class="col-md-6 offset-md-3 col-xs-12"><h1 class="text-xs-center">Your Settings</h1><ul class="error-messages" golgi:prop="errorsEl"></ul><form golgi:on_submit="submitSettings"><fieldset><fieldset class="form-group"><input golgi:prop="image" value="golgi:bind=image" class="form-control" type="text" placeholder="URL of profile picture"></fieldset><fieldset class="form-group"><input golgi:prop="username" value="golgi:bind=username" class="form-control form-control-lg" type="text" placeholder="Username"></fieldset><fieldset class="form-group"><textarea golgi:prop="bio" value="golgi:bind=bio" class="form-control form-control-lg" rows="8" placeholder="Short bio about you"></textarea></fieldset><fieldset class="form-group"><input golgi:prop="email" value="golgi:bind=email" class="form-control form-control-lg" type="text" placeholder="Email"></fieldset><fieldset class="form-group"><input golgi:prop="password" value="golgi:bind=password" class="form-control form-control-lg" type="password" placeholder="New Password"></fieldset><button class="btn btn-lg btn-primary pull-xs-right">Update Settings</button></fieldset></form><hr><button class="btn btn-outline-danger" golgi:on_click="logout">Or click here to logout.</button></div></div></div></div>',this.name=e+"-"+o}setState(e){e.name&&(this.name=e.name)}async submitSettings(e){e.preventDefault();var e={bio:this.bio.value,email:this.email.value,image:this.image.value,username:this.username.value,password:this.password.value},e=await this.rootComponent.apis.updateUser(e);e.errors?this.rootComponent.addErrors(e.errors,this.errorsEl):(this.rootComponent.loggedIn(e.user),this.returnTo?(e={author:e.user.username},this.rootComponent.switchToPage(this.returnTo,e)):this.rootComponent.switchToPage("home_page"))}logout(){this.rootComponent.loggedOut()}show(e){e.style="display:"}hide(e){e.style="display: none"}onSelected(e){e&&e.returnTo&&(this.returnTo=e.returnTo);e=this.rootComponent.user;this.golgi_state.settings_form={image:e.image,username:e.username,bio:e.bio,email:e.email,password:""},this.rootComponent.clearErrors(this.errorsEl)}onBeforeState(){this.addStateMap("settings_form")}})});
golgi_components.push(function load(){let o="conduit-signup",t=-1;customElements.define(o,class extends HTMLElement{constructor(){super(),t++;this.html='<div class="auth-page"><div class="container page"><div class="row"><div class="col-md-6 offset-md-3 col-xs-12"><h1 class="text-xs-center">Sign Up</h1><p class="text-xs-center"><a href="#" golgi:on_click="switchToLogin">Have an account?</a></p><ul class="error-messages" golgi:prop="errorsEl"></ul><form golgi:on_submit="signup"><fieldset><fieldset class="form-group"><input golgi:prop="username" class="form-control form-control-lg" type="text" placeholder="Username"></fieldset><fieldset class="form-group"><input golgi:prop="email" class="form-control form-control-lg" type="email" placeholder="Email"></fieldset><fieldset class="form-group"><input golgi:prop="password" class="form-control form-control-lg" type="password" placeholder="Password"></fieldset><button class="btn btn-lg btn-primary pull-xs-right">Sign In</button></fieldset></form></div></div></div></div>',this.name=o+"-"+t}setState(o){o.name&&(this.name=o.name),o.root&&(this.root=o.root,o.root.login_page=this)}async signup(o){o.preventDefault(),this.errorsEl.textContent="";var o=await this.rootComponent.apis.registerUser(this.username.value,this.email.value,this.password.value);o.errors?this.rootComponent.addErrors(o.errors,this.errorsEl):(this.rootComponent.loggedIn(o.user),this.returnTo?(this.rootComponent.showLoggedInOptions(),o={returnTo:this.returnTo},this.rootComponent.switchToPage(this.returnTo,o)):this.rootComponent.switchToPage("home_page"))}switchToLogin(){var o={returnTo:this.returnTo};this.rootComponent.switchToPage("login",o)}onSelected(o){this.rootComponent.clearErrors(this.errorsEl),this.username.value="",this.email.value="",this.password.value="",o&&(this.returnTo=o.returnTo)}})});
golgi_components.push(function load(){let t="conduit-tag",e=-1;customElements.define(t,class extends HTMLElement{constructor(){super(),e++;this.html='<a class="tag-pill tag-default" href="#">golgi:bind</a>',this.name=t+"-"+e}setState(t){t.name&&(this.name=t.name)}})});
export {golgi_components}